---
title: ใช้ตัวเชื่อมต่อ SAP BW ใน Power BI Desktop (ตัวอย่าง)
description: ใช้ตัวเชื่อมต่อ SAP BW ใน Power BI Desktop (ตัวอย่าง)
services: powerbi
documentationcenter: ''
author: davidiseminger
manager: kfile
backup: ''
editor: ''
tags: ''
qualityfocus: no
qualitydate: ''
ms.service: powerbi
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: powerbi
ms.date: 03/06/2018
ms.author: davidi
LocalizationGroup: Connect to data
ms.openlocfilehash: 84ee8e7c6dd92c5400b6e9d44fab03ad347084d9
ms.sourcegitcommit: e31fc1f6e4af427f8b480c8dbc537c3617c9b2c0
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 03/22/2018
---
# <a name="use-the-sap-bw-connector-in-power-bi-desktop"></a>ใช้ตัวเชื่อมต่อ SAP BW ใน Power BI Desktop (ตัวอย่าง)
ด้วย Power BI Desktop คุณสามารถเข้าถึงข้อมูล**BusinessWarehouse SAP (แบนด์วิดท์)** ได้

## <a name="installation-of-sap-bw-connector"></a>การติดตั้งตัวเชื่อมต่อแบนด์วิดท์ SAP
การใช้**ตัวเชื่อมต่อแบนด์วิดท์ SAP** ไปที่ขั้นตอนการติดตั้งต่อไปนี้:

1. ติดตั้งไลบรารี **SAP NetWeaver** บนเครื่องคอมพิวเตอร์ของคุณ คุณสามารถเรียกดูไลบรารี **SAP Netweaver** จากผู้ดูแลระบบ SAP ของคุณ หรือดูได้โดยตรงจาก[ศูนย์ดาวน์โหลดซอฟต์แวร์ SAP](https://support.sap.com/swdc) เนื่องจาก**ศูนย์ดาวน์โหลดซอฟต์แวร์ SAP**นั้นมีการเปลี่ยนแปลงโครงสร้างบ่อยครั้ง คำแนะนำการนำทางที่เฉพาะเจาะจงมากกว่านี้ในเว็บไซต์ดังกล่าวจึงไม่พร้อมใช้งาน โดยปกติแล้วไลบรารี **SAP NetWeaver** จะรวมอยู่ในการติดตั้งเครื่องมือลูกค้า SAP ด้วย
   
   คุณอาจสามารถค้นหา*บันทึกย่อ SAP #1025361*เพื่อให้ได้ตำแหน่งการดาวน์โหลดสำหรับเวอร์ชันล่าสุดได้ ตรวจสอบให้แน่ใจว่าสถาปัตยกรรมสำหรับไลบรารี**SAP NetWeaver** (32 บิต หรือ 64 บิต) ตรงกับการติดตั้ง**Power BI Desktop**ของคุณ จากนั้นติดตั้งไฟล์ทั้งหมดที่รวมอยู่ใน**SAP NetWeaver RFC SDK** ตามบันทึกย่อ SAP
2. กล่องโต้ตอบ**การรับข้อมูล**รวมรายการที่ใส่เข้าไปสำหรับ**เซิร์ฟเวอร์แอปพลิเคชันของ SAP Business Warehouse**และ**เซิร์ฟเวอร์ข้อความ SAP Business Warehouse**ในประเภท**ฐานข้อมูล** 
   
   ![](media/desktop-sap-bw-connector/sap_bw_2a.png)

## <a name="sap-bw-connector-features"></a>คุณลักษณะของตัวเชื่อมต่อแบนด์วิดท์ SAP
**ตัวเชื่อมต่อแบนด์วิดท์ SAP**ใน Power BI Desktop ช่วยให้คุณนำเข้าข้อมูลจากคิวบ์**เซิร์ฟเวอร์ SAP Business Warehouse**ของคุณ หรือใช้ DirectQuery 

เพื่อเรียนรู้เพิ่มเติมเกี่ยวกับ**ตัวเชื่อมต่อแบนด์วิดท์ SAP**และวิธีการใช้งานกับ DirectQuery ดูบทความ[DirectQuery และ SAP Business Warehouse (แบนด์วิดท์)](desktop-directquery-sap-bw.md)

เมื่อเชื่อมต่อ คุณต้องระบุ*เซิร์ฟเวอร์* *หมายเลขระบบ*และ*ID ลูกค้า*เมื่อต้องสร้างการเชื่อมต่อดังกล่าว

![](media/desktop-sap-bw-connector/sap_bw_3a.png)

นอกจากนี้คุณยังสามารถระบุเพิ่มเติมสอง**ตัวเลือกขั้นสูง**นั่นคือ รหัสภาษาและคำสั่ง MDX แบบกำหนดเองเพื่อเรียกใช้เทียบกับเซิร์ฟเวอร์ที่ระบุได้

![](media/desktop-sap-bw-connector/sap_bw_4a.png)

ถ้าไม่มีการระบุคำสั่ง MDX ระบบจะแสดงด้วยหน้าต่าง**ตัวนำทาง** ซึ่งแสดงรายการของคิวบ์ที่พร้อมใช้งานในเซิร์ฟเวอร์ ซึ่งมีตัวเลือกที่จะเจาะลึกลง แล้วเลือกรายการจากคิวบ์ รวมถึงมิติ และ หน่วยวัดที่พร้อมใช้งาน Power BI แสดงแบบสอบถามและคิวบ์ที่แสดงผลโดย[แบนด์วิดท์ส่วนติดต่อการวิเคราะห์แบบเปิด OLAP BAPIs](https://help.sap.com/saphelp_nw70/helpdata/en/d9/ed8c3c59021315e10000000a114084/content.htm)

เมื่อคุณเลือกอย่างน้อยหนึ่งรายการจากเซิร์ฟเวอร์ ตัวอย่างของตารางผลลัพธ์ถูกสร้างขึ้นตามการเลือก

![](media/desktop-sap-bw-connector/sap_bw_5.png)

นอกจากนี้ หน้าต่าง**ตัวนำทาง**ยังมีบาง**ตัวเลือกการแสดง**ที่ช่วยให้คุณสามารถทำสิ่งต่อไปนี้:

* **แสดงผล*เฉพาะรายการที่เลือกเท่านั้น*เทียบกับ*รายการทั้งหมด* (มุมมองเริ่มต้น):** ตัวเลือกนี้จะมีประโยชน์สำหรับการตรวจสอบชุดสุดท้ายของรายการที่เลือก วิธีการทางเลือกในการดูส่วนนี้คือการเลือก*ชื่อคอลัมน์*ในพื้นที่การ*แสดงตัวอย่าง*
* **เปิดใช้งานการแสดงตัวอย่างข้อมูล (ลักษณะการทำงานเริ่มต้น):** นอกจากนี้ คุณยังสามารถควบคุมว่าควรแสดงตัวอย่างข้อมูลในกล่องโต้ตอบนี้หรือไม่ การปิดใช้งานการแสดงตัวอย่างข้อมูลช่วยลดปริมาณการเรียกเซิร์ฟเวอร์ เนื่องจากจะไม่ร้องขอข้อมูลสำหรับตัวอย่างอีกต่อไป
* **ชื่อทางเทคนิค:** แบนด์วิดท์ SAP สนับสนุนแนวคิด*ชื่อทางเทคนิค*สำหรับวัตถุภายในคิวบ์ ชื่อทางเทคนิคอนุญาตให้เป็นเจ้าของคิวบ์แสดงชื่อ*ผู้ใช้ที่เป็นมิตร*สำหรับวัตถุคิวบ์ ซึ่งตรงข้ามกับ*ชื่อจริง*ที่แสดงสำหรับวัตถุเหล่านั้นในคิวบ์

![](media/desktop-sap-bw-connector/sap_bw_6.png)

หลังจากเลือกวัตถุทั้งหมดที่จำเป็นใน**ตัวนำทาง**แล้ว คุณสามารถตัดสินใจว่าต้องทำสิ่งใดต่อไปโดยการเลือกหนึ่งในปุ่มต่อไปนี้ที่ด้านล่างของหน้าต่าง**ตัวนำทาง**:

* เลือกตัวเปิด**การโหลด**ที่โหลดทั้งชุดของแถวสำหรับตารางผลลัพธ์ลงในแบบจำลองข้อมูล Power BI Desktop จากนั้นนำคุณไปยังมุมมอง**รายงาน**ที่คุณสามารถเริ่มสร้างภาพจากข้อมูล หรือทำการปรับเปลี่ยนเพิ่มเติมโดยใช้มุมมอง**ข้อมูล**หรือ**ความสัมพันธ์**
* การเลือก**แก้ไข**จะนำ**ตัวแก้ไขแบบสอบถาม**ขึ้นมา ซึ่งคุณสามารถดำเนินการแปลงข้อมูลเพิ่มเติมและกรองขั้นตอนต่าง ๆ ก่อนทั้งชุดของแถวจะถูกนำไปในแบบจำลองข้อมูล Power BI Desktop

นอกเหนือจากการนำเข้าข้อมูลจากคิวบ์**แบนด์วิดท์ SAP** โปรดจำไว้ว่าคุณยังสามารถนำเข้าข้อมูลจากหลากหลายแหล่งข้อมูลใน Power BI Desktop จากนั้น คุณสามารถรวมเข้าด้วยกันลงในรายงานเดียว ซึ่งแสดงสถานการณ์สมมติที่น่าสนใจทุกประเภทสำหรับการรายงานและการวิเคราะห์ เพิ่มเติมจากข้อมูล**แบนด์วิดท์ SAP**

## <a name="troubleshooting"></a>แนวทางการแก้ไขปัญหา
ส่วนนี้แสดงสถานการณที่ต้องแก้ไขปัญหาเบื้องต้น (และโซลูชัน) สำหรับการทำงานกับเวอร์ชันแสดงตัวอย่างนี้ของตัวเชื่อมต่อ**แบนด์วิดท์ SAP**

1. ข้อมูลตัวเลขจาก**แบนด์วิดท์ SAP**ส่งกลับจุดทศนิยมแทนการส่งเครื่องหมายจุลภาค ตัวอย่างเช่น 1000000 ถูกส่งกลับเป็น 1.000.000
   
   **แบนด์วิดท์ SAP**ส่งกลับข้อมูลทศนิยมด้วย *,* (เครื่องหมายจุลภาค) หรือ *.* อย่างใดอย่างหนึ่ง (จุด) เป็นตัวคั่นทศนิยม เมื่อต้องการระบุควรใช้**แบนด์วิดท์ SAP**ใดสำหรับตัวคั่นทศนิยม โปรแกรมควบคุมที่ใช้โดย**Power BI Desktop**เรียก*BAPI_USER_GET_DETAIL* การเรียกนี้ส่งกลับโครงสร้างที่เรียกว่า**ค่าเริ่มต้น**ซึ่งมีช่องข้อมูลที่เรียกว่า*DCPFM*ที่จัดเก็บ*สัญกรณ์แบบทศนิยม* ซึ่งจะใช้หนึ่งในสามค่าดังต่อไปนี้:
   
       ‘ ‘ (space) = Decimal point is comma: N.NNN,NN
       'X' = Decimal point is period: N,NNN.NN
       'Y' = Decimal point is N NNN NNN,NN
   
   ลูกค้าที่ีรายงานปัญหานี้ที่พบว่าการเรียก*BAPI_USER_GET_DETAIL*ล้มเหลวสำหรับผู้ใช้บางราย (ผู้ใช้ที่แสดงข้อมูลไม่ถูกต้อง) และมีข้อความข้อผิดพลาดที่คล้ายกับต่อไปนี้:
   
       You are not authorized to display users in group TI:
           <item>
               <TYPE>E</TYPE>
               <ID>01</ID>
               <NUMBER>512</NUMBER>
               <MESSAGE>You are not authorized to display users in group TI</MESSAGE>
               <LOG_NO/>
               <LOG_MSG_NO>000000</LOG_MSG_NO>
               <MESSAGE_V1>TI</MESSAGE_V1>
               <MESSAGE_V2/>
               <MESSAGE_V3/>
               <MESSAGE_V4/>
               <PARAMETER/>
               <ROW>0</ROW>
               <FIELD>BNAME</FIELD>
               <SYSTEM>CLNTPW1400</SYSTEM>
           </item>
   
   เมื่อต้องแก้ไขข้อผิดพลาดนี้ ผู้ใช้ต้องขอให้ผู้ดูแลระบบ SAP อนุญาตให้ผู้ใช้ SAPBW ที่ถูกใช้ใน Power BI มีสิทธิ์ในการดำเนินการ*BAPI_USER_GET_DETAIL* ควรตรวจสอบว่าผู้ใช้นั้นมีค่า*DCPFM*ที่กำหนดตามที่อธิบายไว้ก่อนหน้านี้ในแนวทางการแก้ไขปัญหาหรือไม่
2. **การเชื่อมต่อสำหรับแบบสอบถาม SAP BEx**
   
   คุณสามารถดำเนินการแบบสอบถาม**BEx**ใน Power BI Desktop ได้โดยการเปิดใช้งานคุณสมบัติเฉพาะ ดังที่แสดงในรูปต่อไปนี้:
   
   ![](media/desktop-sap-bw-connector/sap_bw_8.png)

## <a name="next-steps"></a>ขั้นตอนถัดไป
สำหรับข้อมูลเพิ่มเติมเกี่ยวกับ SAP HANA และ DirectQuery กรุณาดูที่แหล่งที่มาต่อไปนี้:

* [DirectQuery และ SAP HANA](desktop-directquery-sap-hana.md)
* [DirectQuery ใน Power BI](desktop-directquery-about.md)
* [แหล่งข้อมูลที่สนับสนุนโดย DirectQuery](desktop-directquery-data-sources.md)
