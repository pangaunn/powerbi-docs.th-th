---
title: 'บทช่วยสอน: สร้างคอลัมน์จากการคำนวณใน Power BI Desktop'
description: 'บทช่วยสอน: สร้างคอลัมน์จากการคำนวณใน Power BI Desktop'
services: powerbi
documentationcenter: ''
author: davidiseminger
manager: kfile
backup: ''
editor: ''
tags: ''
qualityfocus: no
qualitydate: ''
ms.service: powerbi
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: powerbi
ms.date: 12/06/2017
ms.author: davidi
LocalizationGroup: Learn more
ms.openlocfilehash: acdaa95908cd03006170eb06ddfc780c836c64ac
ms.sourcegitcommit: 88c8ba8dee4384ea7bff5cedcad67fce784d92b0
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 02/24/2018
---
# <a name="tutorial-create-calculated-columns-in-power-bi-desktop"></a>บทช่วยสอน: สร้างคอลัมน์จากการคำนวณใน Power BI Desktop
ในบางครั้งข้อมูลที่คุณกำลังวิเคราะห์อยู่นั้นไม่มีเขตข้อมูลเฉพาะที่จำเป็นเพื่อให้ได้ผลลัพธ์ที่คุณต้องการ ตรงนี้คือที่ที่คอลัมน์จากการคำนวณเข้ามา คอลัมน์จากการคำนวณใช้สูตรนิพจน์การวิเคราะห์ข้อมูล (Data Analysis Expressions: DAX) ในการกำหนดค่าของคอลัมน์ ค่าเหล่านั้นสามารถเป็นอะไรก้ได้ ไม่ว่าจะเป็นค่าข้อความที่นำมารวมกันจากสองคอลัมน์ที่อยู่ที่ใดที่หนึ่งในแบบจำลอง หรือการคำนวณค่าตัวเลขจากค่าอื่น ๆ ตัวอย่างเช่น สมมติว่าข้อมูลของคุณมีคอลัมน์เมืองและรัฐ (เป็นเขตข้อมูลในรายการเขตข้อมูล) แต่คุณต้องการเพียงหนึ่งเขตข้อมูลสำหรับตำแหน่งที่ตั้งที่มีทั้งสองคอลัมน์เป็นค่าเดี่ยว เช่น Miami, FL. นี่คือสิ่งที่เราใช้คอลัมน์จากการคำนวณ

คอลัมน์จากการคำนวณจะคล้ายกับหน่วยวัดในทั้งสองคอลัมน์ที่ยึดตามสูตร DAX แต่วิธีการใช้จะแตกต่างกัน หน่วยวัดใช้บ่อยครั้งที่สุดในพื้นที่ค่าของการแสดงภาพ เพื่อคำนวณผลลัพธ์ที่ยึดตามเขตข้อมูลอื่น ๆ ที่คุณมีบนแถวในตาราง หรือในแกน คำอธิบายแผนภูมิ หรือพื้นที่กลุ่มของภาพ ในทางกลับกัน คอลัมน์จากการคำนวณจะใช้เมื่อคุณต้องการให้ผลลัพธ์ของคอลัมน์ในแถวนั้นอยู่ในตาราง หรือในแกน คำอธิบายแผนภูมิ หรือในพื้นที่กลุ่ม

บทช่วยสอนนี้จะแนะนำคุณเกี่ยวกับการทำความเข้าใจและสร้างคอลัมน์ของคุณเองจากการคำนวณใน Power BI Desktop ซึ่งมีไว้สำหรับผู้ใช้ Power BI ที่คุณคุ้นเคยกับการใช้ Power BI Desktop เพื่อสร้างแบบจำลองที่ขั้นสูงขึ้น ถึงตรงนี้คุณควรคุ้นเคยกับการใช้ Query เพื่อนำเข้าข้อมูล ทำงานกับหลายตารางที่เกี่ยวข้องและเพิ่มเขตข้อมูลไปยังพื้นที่รายงานแล้ว ถ้าคุณยังไม่คุ้นเคยกับ Power BI Desktop ให้ตรวจดู[เริ่มต้นใช้งาน Power BI Desktop](desktop-getting-started.md)

เพื่อทำขั้นตอนในบทช่วยสอนนี้ให้สำเร็จ คุณจะจำเป็นต้องดาวน์โหลดไฟล์[ตัวอย่างการขาย Contoso สำหรับ Power BI Desktop](http://download.microsoft.com/download/4/6/A/46AB5E74-50F6-4761-8EDB-5AE077FD603C/Contoso%20Sales%20Sample%20for%20Power%20BI%20Desktop.zip) นี่คือตัวอย่างไฟล์เดียวกันกับที่ใช้สำหรับบทช่วยสอน[สร้างหน่วยวัดของคุณเองใน Power BI Desktop](desktop-tutorial-create-measures.md) ซึ่งจะรวมข้อมูลยอดขายจากบริษัทสมมติไว้นั่นคือ บริษัท Contoso, Inc. เนื่องจากข้อมูลในไฟล์ถูกนำเข้าจากฐานข้อมูลหนึ่ง คุณจะไม่สามารถเชื่อมต่อกับแหล่งข้อมูลดังกล่าวหรือดูในตัวแก้ไขคิวรี่ได้ เมื่อคุณมีไฟล์ดังกล่าวบนคอมพิวเตอร์ของคุณเอง ให้คุณเปิดไฟล์ขึ้นใน Power BI Desktop

## <a name="lets-create-a-calculated-column"></a>เรามาสร้างคอลัมน์จากการคำนวณกัน
สมมติว่าเราต้องการแสดงประเภทผลิตภัณฑ์ร่วมกับประเภทย่อยของผลิตภัณฑ์ให้เป็นค่าเดียวในแถว เช่น โทรศัพท์มือถือ –อุปกรณ์เสริม โทรศัพท์มือถือ – สมาร์ทโฟน & PDA และอื่น ๆ ในมุมมองรายงานหรือมุมมองข้อมูล (เราจะใช้มุมมองรายงานที่นี่) ถ้าเราดูที่ตารางผลิตภัณฑ์ของเราในรายการเขตข้อมูล เราจะเห็นว่าไม่มีเขตข้อมูลใดที่ให้ในสิ่งที่เราต้องการ อย่างไรก็ตาม เรามีเขตข้อมูล ProductCategory และ ProductSubcategory แต่ละรายการอยู่ในตารางของตนเอง

 ![](media/desktop-tutorial-create-calculated-columns/calccol_fileds_nonewcol.png)

เราจะสร้างคอลัมน์จากการคำนวณใหม่เพื่อรวมค่าจากสองคอลัมน์นี้ให้เป็นค่าใหม่สำหรับคอลัมน์ใหม่ของเรา สิ่งที่น่าสนใจคือ เราจำเป็นต้องรวมข้อมูลจากสองตารางนี้ลงในคอลัมน์เดียว เนื่องจากเรากำลังจะใช้ DAX เพื่อสร้างคอลัมน์ใหม่ของเรา เราสามารถใช้ประโยชน์จากพลังอันเต็มเปี่ยมของแบบจำลองที่เรามี รวมถึงความสัมพันธ์ระหว่างตารางต่าง ๆ ที่มีอยู่แล้ว

### <a name="to-create-a-productfullcategory-column"></a>ในการสร้างคอลัมน์ ProductFullCategory
1.  คลิกขวาหรือคลิกลูกศรลงที่ตาราง**ProductSubcategory**ในรายการเขตข้อมูล จากนั้นคลิก**คอลัมน์ใหม่** ขั้นตอนนี้จะทำให้คุณมั่นใจว่าจะมีการเพิ่มคอลัมน์ใหม่ของเราไปยังตาราง ProductSubcategory
    
    ![](media/desktop-tutorial-create-calculated-columns/calccol_fileds_newcolumn.png)
    
    แถบสูตรปรากฏขึ้นตามแนวด้านบนของพื้นที่รายงานหรือตารางข้อมูล นี่คือที่ที่เราสามารถเปลี่ยนชื่อคอลัมน์ของเราและป้อนสูตร DAX ได้
    
    ![](media/desktop-tutorial-create-calculated-columns/calccol_fileds_newcolumnformula.png)
    
    ตามค่าเริ่มต้น คอลัมน์จากการคำนวณใหม่ถูกตั้งชื่อเป็น คอลัมน์ ถ้าเราไม่เปลี่ยนชื่อ เมื่อเราสร้างอีกครั้ง คอลัมน์ถัดไปจะมีชื่อเป็นคอลัมน์ 2, คอลัมน์ 3 ต่อไปเรื่อย ๆ เราต้องการให้คอลัมน์ของเราเป็นที่ระบุได้มากยิ่งขึ้น ดังนั้นเราจะตั้งชื่อใหม่ให้คอลัมน์ของเรา
    
2.  เนื่องจากชื่อ**คอลัมน์**จะทำไฮไลท์อยู่แล้วในแถบสูตร เพียงแค่พิมพ์**ProductFullCategory**
    
    ตอนนี้คุณสามารถใส่สูตรของเราได้ เราต้องการให้ค่าในคอลัมน์ใหม่ของเราเริ่มต้นด้วยชื่อ ProductCategory จากตาราง ProductCategory เนื่องจากคอลัมน์นี้อยู่ในตารางอื่นแต่เป็นตารางที่เกี่ยวข้อง เราจะใช้ฟังก์ชัน[RELATED (เกี่ยวข้อง)](https://msdn.microsoft.com/library/ee634202.aspx)เพื่อช่วยให้เราได้คอลัมน์นี้
    
3.  หลังเครื่องหมายเท่ากับ พิมพ์**R** คุณจะเห็นรายการที่แนะนำแบบเลื่อนลงที่ปรากฏพร้อมกับฟังก์ชัน DAX ทั้งหมดที่เริ่มต้นด้วยตัวอักษร R. ยิ่งเราพิมพ์มากเท่าไหร่ เรายิ่งมีรายการคำแนะนำที่ปรับสัดส่วนใกล้กับฟังก์ชันที่เราต้องการมากเท่านั้น ถัดจากฟังก์ชันดังกล่าว คุณจะเห็นคำอธิบายของฟังก์ชัน เลือก**RELATED (เกี่ยวข้อง)** โดยการเลื่อนลง แล้วกด Enter
    
    ![](media/desktop-tutorial-create-calculated-columns/calccol_fileds_pfc_1.png)
    
    วงเล็บเปิดปรากฏพร้อมกับรายการที่แนะนำอีกรายการสำหรับคอลัมน์พร้อมใช้งานทั้งหมด ที่เราสามารถส่งไปยังฟังก์ชัน RELATED ได้ รายการคำอธิบายและรายละเอียดเกี่ยวกับพารามิเตอร์ที่คาดหมายจะปรากฏขึ้นด้วยเช่นกัน
    
    ![](media/desktop-tutorial-create-calculated-columns/calccol_fileds_pfc_2.png)
    
    นิพจน์ปรากฏตลอดเวลาระหว่างวงเล็บปิดและวงเล็บปิด ในกรณีนี้ นิพจน์ของเราจะประกอบด้วยอาร์กิวเมนต์เดี่ยวที่ส่งผ่านไปยังฟังก์ชัน RELATED คอลัมน์ที่เกี่ยวข้องที่ส่งกลับค่า รายการของคอลัมน์จะถูกย่อลงโดยอัตโนมัติเพื่อแสดงเฉพาะคอลัมน์ที่เกี่ยวข้อง ในกรณีนี้ เราต้องการให้คอลัมน์ ProductCategory ในตาราง ProductCategory
    
    เลือก**ProductCategory [ProductCategory]** แล้วพิมพ์วงเล็บปิด
    
    > [!TIP]
    > ข้อผิดพลาดทางไวยากรณ์มักเกิดขึ้นจากวงเล็บปิดที่วางผิดตำแหน่ง หรือขาดหายไป แต่บ่อยครั้งที่ Power BI Desktop จะเพิ่มข้อความให้ถ้าคุณลืม
    > 
    > 
    
    ![](media/desktop-tutorial-create-calculated-columns/calccol_fileds_pfc_3.png)
    
4. เราต้องการเพิ่มสัญลักษณ์เส้นประเพื่อแยกแต่ละค่า ดังนั้น หลังจากวงเล็บปิดของนิพจน์แรก พิมพ์ช่องว่าง เครื่องหมาย (&), เครื่องหมายอัญประกาศ ช่องว่าง เส้นประ (-) ช่องว่างอีกช่อง เครื่องหมายอัญประกาศปิด และเครื่องหมาย (&) อีกอันหนึ่ง ในตอนนี้สูตรของคุณควรมีลักษณะดังนี้:
    
    **ProductFullCategory = RELATED(ProductCategory[ProductCategory]) & " - " &**
    
    > [!TIP]
    > คลิกที่เครื่องหมายรูปตัววี (V) ที่ทางด้านขวาของแถบสูตรเพื่อขยายตัวแก้ไขสูตร คลิก Alt และ Enter เพื่อย้ายลงหนึ่งบรรทัด และแท็บเพื่อย้ายสิ่งต่าง ๆ
    > 
    > 
    
5.  สุดท้าย ใส่วงเล็บเปิดอีกหนึ่งอื่น จากนั้นเลือกคอลัมน์ **[ProductSubcategory]** เพื่อทำสูตรให้เสร็จสิ้น สูตรควรมีลักษณะดังนี้:
    
    ![](media/desktop-tutorial-create-calculated-columns/calccol_fileds_pfc_5.png)
    
    คุณจะสังเกตเห็นว่าเราไม่ได้ใช้อีกฟังก์ชัน RELATED ในนิพจน์ที่สองที่เรียกคอลัมน์ ProductSubcategory ทั้งนี้เนื่องจากคอลัมน์นี้อยู่ในตารางเดียวกับตารางที่เราสร้างคอลัมน์ใหม่ของเราอยู่แล้ว เราสามารถใส่ [ProductCategory] ที่มีชื่อตาราง (คุณสมบัติเต็ม) หรือไม่มี (ไม่มีคุณสมบัติเหมาะสม) ได้
    
6.  ทำสูตรให้เสร็จสมบูรณ์โดยการกด Enter หรือคลิกบนเครื่องหมายถูกในแถบสูตร สูตรได้รับการตรวจสอบและเพิ่มลงในรายการเขตข้อมูลในตาราง **ProductSubcategory**
    
    ![](media/desktop-tutorial-create-calculated-columns/calccol_fileds_pfc_6.png)
    
    คุณจะสังเกตเห็นว่าคอลัมน์จากการคำนวณมีไอคอนพิเศษในรายการเขตข้อมูล ซึ่งแสดงว่าคอลัมน์เหล่านี้ประกอบด้วยสูตร คอลัมน์จะปรากฏขึ้นดังนี้เท่านั้นใน Power BI Desktop ในบริการ PowerBI (ไซต์ Power BI ของคุณ) เราไม่สามารถเปลี่ยนแปลงสูตรได้ ดังนั้น เขตข้อมูลคอลัมน์จากการคำนวณจะไม่มีไอคอนใด ๆ
    
## <a name="lets-add-our-new-column-to-a-report"></a>ลองเพิ่มคอลัมน์ใหม่ของเราไปยังรายงานหนึ่ง
ตอนนี้ เราสามารถเพิ่มคอลัมน์ ProductFullCategory ใหม่ของเราไปยังพื้นที่รายงานได้ มาดูยอดขายโดยแยกตาม ProductFullCategory กัน

ลากคอลัมน์ **ProductFullCategory** จากตาราง **ProductSubcategory** ลงบนพื้นที่รายงาน จากนั้น ลากเขตข้อมูล**ยอดขาย**จากตาราง **ยอดขาย**ลงในแผนภูมิ

![](media/desktop-tutorial-create-calculated-columns/calccol_fileds_report_1.png)

## <a name="lets-create-another"></a>มาสร้างอีกอันกัน
หลังจากที่คุณทราบวิธีการสร้างคอลัมน์จากการคำนวณแล้ว เรามาสร้างอีกครั้งกัน

ตัวอย่างการขายของ Contoso สำหรับแบบจำลอง Power BI Desktop ประกอบด้วยข้อมูลยอดขายสำหรับร้านค้าที่ยังเปิดขายอยู่ (Active) และไม่เปิดขายแล้ว (Inactive) เราต้องการให้ชัดเจนจริง ๆ ว่าข้อมูลที่แสดงสำหรับร้านค้าที่ไม่เปิดขายแล้วจะถูกระบุเป็นเช่นนั้น เพื่อให้ได้ผลดังกล่าว เราต้องการตั้งชื่อเขตข้อมูลเป็น Active StoreName ในการทำเช่นนี้ เราจะสร้างคอลัมน์อื่น ในกรณีนี้ เมื่อร้านค้าไม่เปิดขาย เราต้องการคอลัมน์ Active StoreName ใหม่ของ (เป็นเขตข้อมูลหนึ่ง) เพื่อแสดงชื่อของร้านค้าเป็น "ไม่เปิดขาย (Inactive)" แต่แสดงชื่อจริงของร้านค้าเมื่อเป็นร้านค้าที่เปิดขาย (Active)

โชคดีที่ตาราง Stores ของเรามีคอลัมน์ที่ชื่อว่า Status (สถานะ) ที่มีค่าเป็น On สำหรับร้านค้าที่เปิดขายอยู่ Off สำหรับร้านค้าที่ไม่เปิดขาย เราสามารถทดสอบค่าเหล่านี้สำหรับแต่ละแถวในคอลัมน์สถานะเพื่อสร้างค่าใหม่ในคอลัมน์ของเราใหม่ได้

### <a name="to-create-an-active-storename-column"></a>ในการสร้างคอลัมน์ Active StoreName
1.  สร้างคอลัมน์จากการคำนวณใหม่ที่ชื่อว่า**Active StoreName**ในตาราง**ร้านค้า (Stores)**
    
    สำหรับคอลัมน์นี้ สูตร DAX ของเรากำลังจะตรวจสอบแต่ละสถานะของร้านค้า ถ้าสถานะร้านค้าเป็น On สูตรของเราจะส่งกลับชื่อร้านค้า และถ้าเป็น Off สูตรจะมีชื่อเป็น "Inactive (ไม่เปิดขาย)" ในการทำเช่นนี้ เราจะใช้ฟังก์ชัน[IF](https://msdn.microsoft.com/library/ee634824.aspx)ทางตรรกะเพื่อทดสอบสถานะร้านค้า และส่งกลับค่าใดค่าหนึ่งถ้าผลลัพธ์เป็น true หรือ false
    
2.  เริ่มพิมพ์ **IF** รายการคำแนะนำจะแสดงสิ่งที่คุณสามารถเพิ่มได้ เลือก**IF**
    
    ![](media/desktop-tutorial-create-calculated-columns/calccol_activestore_1.png)
    
    อาร์กิวเมนต์แรกสำหรับ IF เป็นการทดสอบเชิงตรรกะ เราต้องการทดสอบว่าร้านค้ามีสถานะเป็น "On" หรือไม่
    
3.  พิมพ์วงเล็บเปิด **[** ซึ่งช่วยให้เราสามารถเลือกคอลัมน์จากตารางร้านค้าได้ เลือก **[สถานะ]**
    
    ![](media/desktop-tutorial-create-calculated-columns/calccol_activestore_2.png)
    
4.  หลังจาก **[สถานะ]** พิมพ์ **= "On"** จากนั้นใส่เครื่องหมายจุลภาค (**,**)เพื่อเข้าไปยังอาร์กิวเมนต์ที่สอง เคล็ดลับเครื่องมือแนะนำว่าเราจำเป็นต้องเพิ่มค่าเมื่อผลลัพธ์เป็นจริง
    
    ![](media/desktop-tutorial-create-calculated-columns/calccol_activestore_3.png)
    
5.  ถ้าร้านค้าเป็น On เราต้องการแสดงชื่อของร้านค้า พิมพ์วงเล็บเปิด **[** และเลือกคอลัมน์ **[StoreName]** จากนั้นพิมพ์เครื่องหมายจุลภาคอีกอันเพื่อให้เราสามารถใส่อาร์กิวเมนต์ที่สามของเราได้
    
    ![](media/desktop-tutorial-create-calculated-columns/calccol_activestore_step5.png)
    
6.  เราจำเป็นต้องเพิ่มค่าเมื่อผลลัพธ์เป็นเท็จ ในกรณีนี้เราต้องการให้ค่าเป็น **"Inactive"**
    
    ![](media/desktop-tutorial-create-calculated-columns/calccol_activestore_step6.png)
    
7.  ทำสูตรให้เสร็จสมบูรณ์โดยการกด Enter หรือคลิกบนเครื่องหมายถูกในแถบสูตร สูตรได้รับการตรวจสอบและเพิ่มลงในรายการเขตข้อมูลในตารางร้านค้า
    
    เช่นเดียวกับช่องข้อมูลอื่น ๆ เราสามารถใช้คอลัมน์ Active StoreName ใหม่ของเราได้ในการแสดงภาพต่าง ๆ ในแผนภูมินี้ ร้านค้าที่มีสถานะเป็น On จะแสดงแยกกันตามชื่อร้านค้า แต่ร้านค้าที่มีสถานะเป็น Off จะถูกจัดกลุ่มเข้าด้วยกัน และแสดงเป็น Inactive 
    
    ![](media/desktop-tutorial-create-calculated-columns/calccol_activestore_viz.png)
    
## <a name="what-weve-learned"></a>สิ่งที่เราได้เรียนรู้
คอลัมน์จากการคำนวณสามารถเพิ่มข้อมูลของเราได้ ทำให้การเจาะข้อมูลเชิงลึกทำได้ง่ายขึ้น เราได้เรียนรู้วิธีการสร้างคอลัมน์จากการคำนวณโดยใช้แถบสูตร วิธีการใช้รายการคำแนะนำ และวิธีการที่ดีที่สุดในการตั้งชื่อคอลัมน์ใหม่ของเราไปแล้ว

## <a name="next-steps"></a>ขั้นตอนถัดไป
ถ้าคุณต้องการเจาะลึกลงในสูตร DAX และสร้างคอลัมน์จากการคำนวณด้วยสูตร DAX ขั้นสูงมากขึ้น ดู[พื้นฐาน DAX ใน Power BI Desktop](desktop-quickstart-learn-dax-basics.md) บทความนี้มุ่งเน้นแนวคิดพื้นฐานใน DAX เช่น ไวยากรณ์ ฟังก์ชัน และการทำความเข้าใจบริบทโดยละเอียด

โปรดให้แน่ใจว่าได้เพิ่ม[ข้ออ้างอิง Data Analysis Expressions (DAX)](https://msdn.microsoft.com/library/gg413422.aspx)ไปยังรายการโปรดของคุณ นี่คือที่ที่คุณจะพบข้อมูลเกี่ยวกับ ไวยากรณ์ ตัวดำเนินการ และฟังก์ชัน DAX มากกว่า 200 ฟังก์ชั่นโดยละเอียด

